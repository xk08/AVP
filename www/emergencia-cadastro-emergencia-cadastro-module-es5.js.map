{"version":3,"sources":["./src/app/pages/emergencia-cadastro/emergencia-cadastro.page.html","./src/app/pages/emergencia-cadastro/emergencia-cadastro.module.ts","./src/app/pages/emergencia-cadastro/emergencia-cadastro.page.scss","./src/app/pages/emergencia-cadastro/emergencia-cadastro.page.ts","./src/app/services/emergenciaCadastro/emergencia-cadastro.service.ts"],"names":[],"mappings":"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","file":"emergencia-cadastro-emergencia-cadastro-module-es5.js","sourcesContent":["module.exports = \"<ion-content>\\r\\n  <ion-grid>\\r\\n    <!-- alinha no centro e define pra coluna a resolucao de acordo com o tamanho da tela -->\\r\\n    <ion-row justify-content-center>\\r\\n      <!-- Deixa responsivo -->\\r\\n      <ion-col\\r\\n        size-sm=\\\"8\\\"\\r\\n        size-md=\\\"12\\\"\\r\\n        size-lg=\\\"3\\\"\\r\\n        size-xl=\\\"3\\\"\\r\\n      >\\r\\n\\r\\n        <form #form=\\\"ngForm\\\">\\r\\n\\r\\n          <ion-text text-align=\\\"justify-content-center\\\">Número de pessoas proximas a você</ion-text>\\r\\n\\r\\n          <!-- PRIMEIRO NÚMERO -->\\r\\n          <ion-item>\\r\\n            <ion-icon\\r\\n              name=\\\"person\\\"\\r\\n              color=\\\"primary\\\"\\r\\n              slot=\\\"start\\\"\\r\\n            ></ion-icon>\\r\\n            <ion-input\\r\\n              type=\\\"text\\\"\\r\\n              name=\\\"primeiroNumero\\\"\\r\\n              placeholder=\\\"Primeiro número\\\"\\r\\n              autofocus=\\\"true\\\"\\r\\n              [(ngModel)]='todas.primeiroNumero'\\r\\n              required\\r\\n            ></ion-input>\\r\\n          </ion-item>\\r\\n\\r\\n          <!-- SEGUNDO NÚMERO -->\\r\\n          <ion-item>\\r\\n            <ion-icon\\r\\n              name=\\\"person\\\"\\r\\n              color=\\\"primary\\\"\\r\\n              slot=\\\"start\\\"\\r\\n            ></ion-icon>\\r\\n            <ion-input\\r\\n              type=\\\"text\\\"\\r\\n              name=\\\"segundoNumero\\\"\\r\\n              placeholder=\\\"Segundo número\\\"\\r\\n              autofocus=\\\"true\\\"\\r\\n              [(ngModel)]='todas.segundoNumero'\\r\\n              required\\r\\n            ></ion-input>\\r\\n          </ion-item>\\r\\n\\r\\n          <ion-item>\\r\\n            <ion-icon\\r\\n              name=\\\"person\\\"\\r\\n              color=\\\"primary\\\"\\r\\n              slot=\\\"start\\\"\\r\\n            ></ion-icon>\\r\\n            <ion-textarea\\r\\n              name=\\\"frase\\\"\\r\\n              autofocus=\\\"true\\\"\\r\\n              [(ngModel)]='todas.frase'\\r\\n              required\\r\\n              rows=\\\"4\\\"\\r\\n              cols=\\\"10\\\"\\r\\n              placeholder=\\\"Frase que você gosta e admira...\\\"\\r\\n            ></ion-textarea>\\r\\n          </ion-item>\\r\\n          <ion-title>\\r\\n            <ion-label>Foto que você gosta e admira</ion-label>\\r\\n            <ion-item (click)=\\\"abrirGaleria()\\\">\\r\\n              <ion-icon\\r\\n                name=\\\"add\\\"\\r\\n                color=\\\"primary\\\"\\r\\n                slot=\\\"start\\\"\\r\\n              ></ion-icon>\\r\\n              Clique para escolher\\r\\n            </ion-item>\\r\\n          </ion-title>\\r\\n\\r\\n          <!-- BOTÃO DE CADASTRO -->\\r\\n\\r\\n          <ion-button\\r\\n            expand=\\\"block\\\"\\r\\n            type=\\\"submit\\\"\\r\\n            class=\\\"login-button\\\"\\r\\n            [disabled]=\\\"!form.form.valid\\\"\\r\\n            (click)=\\\"saveTodo()\\\"\\r\\n            color='dark'\\r\\n          >\\r\\n            Salvar Informações\\r\\n          </ion-button>\\r\\n        </form>\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n  </ion-grid>\\r\\n\\r\\n</ion-content>\\r\\n\"","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { EmergenciaCadastroPage } from './emergencia-cadastro.page';\r\nimport { SharedModule } from 'src/app/shared/shared.module';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: EmergenciaCadastroPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [SharedModule, RouterModule.forChild(routes)],\r\n  declarations: [EmergenciaCadastroPage]\r\n})\r\nexport class EmergenciaCadastroPageModule {}\r\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL2VtZXJnZW5jaWEtY2FkYXN0cm8vZW1lcmdlbmNpYS1jYWRhc3Ryby5wYWdlLnNjc3MifQ== */\"","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { NgForm } from '@angular/forms';\r\nimport { EmergenciaCadastro } from 'src/app/services/emergenciaCadastro/emergenciaCadastro';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { LoadingController, NavController, Platform } from '@ionic/angular';\r\nimport { EmergenciaCadastroService } from 'src/app/services/emergenciaCadastro/emergencia-cadastro.service';\r\nimport { StorageService } from 'src/app/services/storage/storage.service';\r\nimport { File } from '@ionic-native/file/ngx';\r\nimport { Camera, CameraOptions } from '@ionic-native/camera/ngx';\r\n\r\n@Component({\r\n  selector: 'app-emergencia-cadastro',\r\n  templateUrl: './emergencia-cadastro.page.html',\r\n  styleUrls: ['./emergencia-cadastro.page.scss']\r\n})\r\nexport class EmergenciaCadastroPage implements OnInit {\r\n  @ViewChild('form', null) form: NgForm;\r\n  public idEmergenciaCadastro: string;\r\n  public todas: EmergenciaCadastro = {\r\n    //os dados que estão sendo mantidos\r\n    idAlternativo: '',\r\n    foto: '',\r\n    primeiroNumero: '',\r\n    segundoNumero: '',\r\n    frase: ''\r\n  };\r\n  private blob: Blob;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private loadingController: LoadingController,\r\n    private emergenciaCadastroService: EmergenciaCadastroService,\r\n    private navCtrl: NavController,\r\n    private camera: Camera,\r\n    private platform: Platform,\r\n    private file: File,\r\n    private storageService: StorageService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.idEmergenciaCadastro = this.route.snapshot.params['idAlternativo']; // Why ?\r\n    if (this.idEmergenciaCadastro) {\r\n      this.loadTodo();\r\n    }\r\n  }\r\n\r\n  async loadTodo() {\r\n    const loading = await this.loadingController.create({\r\n      message: 'Carregando \"\"algoo\"\"...'\r\n    });\r\n    await loading.present();\r\n\r\n    this.emergenciaCadastroService.getTodo(this.idEmergenciaCadastro).subscribe(res => {\r\n      loading.dismiss();\r\n      this.todas = res;\r\n    });\r\n  }\r\n\r\n  async saveTodo() {\r\n    const loading = await this.loadingController.create({\r\n      message: 'Salvando os Dados do mecanismo de S.O.S'\r\n    });\r\n    await loading.present();\r\n\r\n    if (this.idEmergenciaCadastro) {\r\n      /* TESTA SE JA EXISTE, ENTÃO FAZ UPDATE */\r\n      this.emergenciaCadastroService.updateTodo(this.todas, this.idEmergenciaCadastro).then(() => {\r\n        loading.dismiss();\r\n        this.navCtrl.navigateBack('/menu/home');\r\n        console.log('Até aqui ta indo, salvo com sucesso');\r\n      });\r\n    } else {\r\n      /* SENÃO EXISTIR, FAZ CADASTRO DE NOVOS DADOS */\r\n      this.emergenciaCadastroService.addTodo(this.todas).then(() => {\r\n        loading.dismiss();\r\n        this.navCtrl.navigateBack('/menu/home');\r\n        console.log('Até aqui ta indo, salvo com sucesso');\r\n      });\r\n    }\r\n  }\r\n\r\n  async abrirGaleria() {\r\n    const opcao: CameraOptions = {\r\n      quality: 30,\r\n      destinationType: this.camera.DestinationType.FILE_URI,\r\n      sourceType: this.camera.PictureSourceType.PHOTOLIBRARY,\r\n      correctOrientation: true\r\n    };\r\n\r\n    try {\r\n      const fileUrl: string = await this.camera.getPicture(opcao);\r\n\r\n      let file: string;\r\n\r\n      if (this.platform.is('ios')) {\r\n        //IOS RETORNA IMG_23456789.jpg\r\n        file = fileUrl.split('/').pop();\r\n      } else {\r\n        //ANDROID RETORNA IMG_23456.jpg?23456789 SENDO ASSIM O TRATAMENTO É DIFERENTE\r\n        file = fileUrl.substring(fileUrl.lastIndexOf('/') + 1, fileUrl.indexOf('?'));\r\n      }\r\n\r\n      const path: string = fileUrl.substring(0, fileUrl.lastIndexOf('/'));\r\n\r\n      //LE A IMAGEM COMO UM ARQUIVO BINÁRIO\r\n      const buffer: ArrayBuffer = await this.file.readAsArrayBuffer(path, file);\r\n      this.blob = new Blob([buffer], { type: 'image/jpg' });\r\n      this.storageService\r\n        .uploadImagemEmergenciaCadastro(this.todas.idAlternativo, this.blob)\r\n        .subscribe(res => {\r\n          this.todas.foto = res;\r\n        });\r\n    } catch (error) {}\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { AngularFirestoreCollection, AngularFirestore } from 'angularfire2/firestore';\r\nimport { EmergenciaCadastro } from './emergenciaCadastro';\r\nimport { map } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class EmergenciaCadastroService {\r\n  private todosCollection: AngularFirestoreCollection<EmergenciaCadastro>;\r\n\r\n  constructor(db: AngularFirestore) {\r\n    this.todosCollection = db.collection<EmergenciaCadastro>('EmergenciaCadastro');\r\n  }\r\n\r\n  getTodos() {\r\n    return this.todosCollection.snapshotChanges().pipe(\r\n      map(actions => {\r\n        return actions.map(a => {\r\n          const data = a.payload.doc.data();\r\n          const id = a.payload.doc.id;\r\n          return { id, ...data };\r\n        });\r\n      })\r\n    );\r\n  }\r\n\r\n  getTodo(id) {\r\n    return this.todosCollection.doc<EmergenciaCadastro>(id).valueChanges();\r\n  }\r\n\r\n  updateTodo(toda: EmergenciaCadastro, id: string) {\r\n    return this.todosCollection.doc(id).update(toda);\r\n  }\r\n\r\n  addTodo(toda: EmergenciaCadastro) {\r\n    return this.todosCollection.add(toda);\r\n  }\r\n\r\n  removeTodo(id) {\r\n    return this.todosCollection.doc(id).delete();\r\n  }\r\n}\r\n"],"sourceRoot":""}